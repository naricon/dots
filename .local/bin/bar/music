#!/usr/bin/env bash

if ! pgrep -f "$HOME/.local/bin/bar/mpd-up" > /dev/null; then
    nohup "$HOME/.local/bin/bar/mpd-up" >/dev/null 2>&1 &
fi

if mpc status | grep -qw "\[playing\]"; then
    status="Playing"
    icon=""
elif mpc status | grep -qw "\[paused\]"; then
    status="Paused"
    icon=""
else
    status="Stopped"
fi

if [[ "$status" == "Stopped" ]]; then
    exit 0
fi

case $button in
  1) mpc prev;;
  2) mpc toggle;;
  3) mpc next;;
  4) mpc volume +5;;
  5) mpc volume -5;;
esac

song=$(mpc | head -n 1)
volume=$(mpc status %volume% | sed "s/\ //")

echo -e "$song $volume"
